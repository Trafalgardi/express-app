let content = '';
let temp = '';

//TODO GRYZ
let http = "http://";
let https = "https://";
let header = "";
if (window.location.host == "localhost:3000") {
    header = http;
} else {
    header = https;
}
$.ajax({
    type: "get",
    url: header + window.location.host + '/api/getOpenTests',
    dataType: "json",
    success: function(data) {
        console.log(data);
        content = "";

        content += addTestsHtml(data.tests[-1]);
        data.categories[-1].forEach(function(el) {
            content += addCatsTestsHtml(el, data);
        });
        $("#container").append(content);
    },
    error: function(jqXHR, textStatus, errorThrown) {
        alert('error ' + textStatus + " " + errorThrown);
    }
});
console.log(temp)
console.log(window.location.host)

function addCatsTestsHtml(cat, data) {
    let content = "";
    content += '<div class="col-12 text-center"><h3>' + cat.name + '</h3></div>';
    if (data.tests[cat.id] !== undefined)
        content += addTestsHtml(data.tests[cat.id]);
    if (data.categories[cat.id] !== undefined)
        data.categories[cat.id].forEach(function(el) {
            content += addCatsTestsHtml(el, data);
        });
    return content;
}

function addTestsHtml(testArr) {
    let content = "";
    testArr.forEach(function(curTest) {
        content += '<div class="col-md-4">'
        content += '    <div class="card mb-4 box-shadow test-item">'
        content += '      <div class="card-img-top text"><p>' + curTest.name + '</p></div>'
        content += '      <div class="card-body">'
        content += '        <div class="d-flex justify-content-between align-items-center">'
        content += '          <div class="btn-group">'
        content += '            <a  href="./test/' + curTest.id + '" class="btn btn-sm btn-outline-secondary">Начать</a>'
        content += '          </div>'
        content += '          <small class="text-muted">' + (JSON.parse(curTest.questions).time) + ' мин.</small>'
        content += '        </div>'
        content += '      </div>'
        content += '    </div>'
        content += '</div>'
    });
    return content;
}